window.changeMod=async(mod=null,isActive=!1)=>{if(!mod||isActive)return!1;const data=new URLSearchParams;data.append("controller","site"),data.append("mod",mod),fetch("/admin/modifications/set_modification",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:data.toString()}).then((response=>response.json())).then((response=>{response&&pageReload()})).catch((error=>console.error("Ошибка:",error)))},window.ddrFormSubmit=async(beforeCb,afterCb)=>{event.preventDefault();const formSelector=event.target;await import("/public/js/vendor/lodash.js");const ddrQuery=await ddrImport("plugins/ddrQuery"),beforeStat=await callFunc(window[beforeCb],formSelector);if(void 0!==typeof beforeStat&&!1===beforeStat)return;const form=(await ddrImport("plugins/ddrForm.js"))(formSelector),{data:data,error:error,status:status,headers:headers}=await ddrQuery.post("admin/common/send_email",form);callFunc(window[afterCb],!!data,error||null)},window.pageReload=function(){location.reload()},window.callFunc=function(func,...params){if(_.isFunction(func))return _.isFunction(func)?func(...params):void 0},window.ddrImport=async function(path=null){if(!path)return!1;path.endsWith(".js")&&(path=path.replace(".js","")),path.startsWith("/")&&(path=path.substr(1));try{const loadedModule=await import(`/public/js/${path}.js`);return loadedModule.default||loadedModule}catch(e){throw console.log(e),e}},window.getSection=function(ops){return new Promise((async function(resolve,reject){try{const{uid:uid=null,selector:selector=null,returnType:returnType="html"}=ops,ddrQuery=await ddrImport("plugins/ddrQuery"),responseType=(location.pathname.substr(1),selector?"text":"json"),{data:data,error:error,status:status,headers:headers}=await ddrQuery.get("ajax/get_section",{uid:uid,responseType:responseType},{responseType:responseType});if("-1"==data)return void console.error('getSection ошибка -> Секции: "'+uid+'" не существует!');selector&&"html"==returnType&&(document.querySelector(selector).innerHTML=data),resolve({data:data,error:error})}catch(e){reject(e),showError(e)}}))},getSection({uid:"k508ajh",selector:"#ddrTest",returnType:"json"}).then((({data:data,error:error})=>{console.log({data:data,error:error})}));