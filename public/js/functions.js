let isIos=/iPhone|iPad|iPod/i.test(navigator.userAgent);tapEvent="ontouchstart"in window&&!isIos?"tap":"click",breakpoints={},["SM","MD","LG","XL"].forEach((function(brName){var val=parseInt($(":root").css("--breakpoint-"+brName.toLowerCase()));window["breakpoint"+brName]=val,breakpoints[brName.toLowerCase()]=val})),getCurrentBreakPoint=function(values){let returnValue,bps=["xs","sm","md","lg","xl"],winW=$(window).width();return bps.forEach((function(bp,k){let bpWidth=breakpoints[bp]||0,nextBpWidth=breakpoints[bps[k+1]]||null;if(winW>=bpWidth&&(null==nextBpWidth||winW<nextBpWidth))return returnValue=bp,!1})),values&&"object"==typeof values&&values[returnValue]||returnValue},window.thisDevice="desktop",/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&(window.thisDevice="mobile"),tapEventInfo=function(e,d){var data,attrs,classes,at="";if("mobile"!=thisDevice||isIos?(attrs=e.target.attributes||!1,classes=e.target.className||!1):(attrs=null!=e.changedTouches&&e.changedTouches[0].target.attributes,classes=null!=e.changedTouches&&e.changedTouches[0].target.className),attrs.length&&$.each(attrs,(function(k,a){at+=" "+a.name})),data={classes:!(!classes||"string"!=typeof classes)&&classes.split(" "),attributes:!(!at||"string"!=typeof at)&&at.trim().split(" ")},null!=d&&d.class){if(data.classes){var fStat=!1;return"object"==typeof d.class?($.each(d.class,(function(k,cls){-1!=data.classes.indexOf(cls)&&(fStat=!0)})),fStat):-1!=data.classes.indexOf(d.class)}return!1}if(null!=d&&d.attribute){if(data.attributes){fStat=!1;return"object"==typeof d.attribute?($.each(d.attribute,(function(k,attr){-1!=data.attributes.indexOf(attr)&&(fStat=!0)})),fStat):-1!=data.attributes.indexOf(d.attribute)}return!1}return!(!data.classes&&!data.attributes)&&data},pageReload=function(){location.reload(),location.reload(),window.location.reload(),window.location.reload(),window.location.reload(),window.location.reload(),self.location.reload(),self.location.reload(),self.location.reload(),self.location.reload(),window.location=window.location},$.fn.imgLoaded=function(func){var i=new Image,imageSrc=$(this).attr("src");i.onload=function(){"function"==typeof func&&func()},i.src=imageSrc},Counter=function(start,order,step){var count=start||0;return function(num){return count=null!=num?num:count,null==order||"+"==order?"-"==order?count-=step:count+=step:count-=step}},searchInObject=function(arrObj,field,value){return arrObj.findIndex((function(element,index){if(element[field]==value)return index}))},isJson=function(str){if(null==str||void 0===str)return!1;try{JSON.parse(str)}catch(e){return!1}return!0},isInt=function(n){return null!=n&&void 0!==n&&("string"!=typeof n?Number(n)===n&&n%1==0:Number(n)+""===n)},isFloat=function(n){return null!=n&&void 0!==n&&("string"!=typeof n?Number(n)===n&&n%1!=0:Number(n)+""===n&&Number(n)%1!=0)},count=function(items){var arrLength=items.length;return null!=arrLength?arrLength:Object.values(items).length},hasIn=function(data,elem,isKey){if(null==elem||null==data||0==data.length)return!1;var findKey;if(null!=isKey&&1==isKey){var keysData=Object.keys(data);return-1!=(findKey=keysData.indexOf(elem))&&data[keysData[findKey]]}return-1!=(findKey=data.indexOf(elem))&&findKey},getFileName=function(fileName,nameOrExt,nameLimit){var fn=fileName.split("."),e=fn.pop(),n=fn.join(".");return null==nameOrExt||1==nameOrExt?(null!=nameLimit&&isInt(nameLimit)&&n.length>nameLimit?n.substr(0,nameLimit):n)||e:2==nameOrExt?e:void 0},$.fn.disableDrop=function(extClasses,callback){function action(e,cb){if(extClasses&&"function"!=typeof extClasses){var stat=!1;if("object"==typeof extClasses)for(var i=0;i<extClasses.length;i++)0!=$(e.target).hasClass(extClasses[i])&&(stat=!0);else 0!=$(e.target).hasClass(extClasses)&&(stat=!0);stat||(e.preventDefault(),cb&&callback&&"function"==typeof callback&&callback(e.target))}else e.preventDefault(),cb&&extClasses&&"function"==typeof extClasses&&extClasses(e.target)}$(this).off(tapEvent).on(tapEvent,(function(e){action(e,!0)})),$(this).off("dragover").on("dragover",(function(e){action(e)})),$(this).off("dragleave").on("dragleave",(function(e){action(e)})),$(this).off("drop").on("drop",(function(e){action(e,!0)}))},$.fn.setAttrib=function(attr,value){return null!=attr&&(0!=$(this).length&&($(this).attr(attr,value||""),void $(this)[0].setAttribute(attr,value||"")))},$.fn.removeAttrib=function(attr){return null!=attr&&(0!=$(this).length&&($(this).prop(attr,!1),$(this).removeAttr(attr),void $(this)[0].removeAttribute(attr)))},$.fn.hasAttr=function(a){var attr=$(this).attr(a);return void 0!==attr&&!1!==attr},disableScroll=function(){var scrollPosition=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];$("html").setAttrib("scroll-position",scrollPosition.join("|")),$("html").setAttrib("previous-overflow",$("html").css("overflow")),$("html").css("overflow","hidden"),window.scrollTo(scrollPosition[0],scrollPosition[1])},enableScroll=function(){var scrollPosition=$("html").attr("scroll-position");scrollPosition&&(scrollPosition=scrollPosition.split("|"),$("html").css("overflow",$("html").attr("previous-overflow")),$("html").removeAttrib("scroll-position"),$("html").removeAttrib("previous-overflow"),$("html").removeAttrib("style"),window.scrollTo(scrollPosition[0],scrollPosition[1]))},$.fn.errorLabel=function(html){var selectors=".field, .textarea, .select, .file, .ddrselect";0==$(this).closest(selectors).length?($(this).siblings("span.error").length>0?$(this).siblings("span.error").html(html):$(this).after('<span class="error">'+html+"</span>"),$(this).addClass("error")):(0==$(this).closest(selectors).find("span.error").length?$(this).closest(selectors).append('<span class="error">'+html+"</span>"):$(this).closest(selectors).find("span.error").html(html),$(this).closest(selectors).addClass("error"))},$.fn.scrollFix=function(settings){var scrTOut,scrollTop,selector=this,ops=$.extend({cls:"fixed",pos:200},settings);(scrollTop=$(window).scrollTop())>ops.pos&&!$(selector).hasClass(ops.cls)?$(selector).addClass(ops.cls):scrollTop<=ops.pos&&$(selector).hasClass(ops.cls)&&$(selector).removeClass(ops.cls),$(window).scroll((function(e){clearTimeout(scrTOut),scrTOut=setTimeout((function(){(scrollTop=$(window).scrollTop())>ops.pos&&!$(selector).hasClass(ops.cls)?$(selector).addClass(ops.cls):scrollTop<=ops.pos&&$(selector).hasClass(ops.cls)&&$(selector).removeClass(ops.cls)}),10)}))},random=function(min,max){return Math.floor(Math.random()*(max-min+1))+min},generateCode=function(mask){for(var letters=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],code="",x=0;x<mask.length;x++)"l"==mask.substr(x,1)?code+=letters[random(0,25)]:"L"==mask.substr(x,1)?code+=letters[random(0,25)].toUpperCase():"n"==mask.substr(x,1)&&(code+=random(0,9));return code},getContenteditable=function(selector){let content=$(selector).html(),temp=document.createElement("div");return""==content?"":(content=content.replace(/<br><br>/gu,"\n").replace(/<div><br><\/div>/gu,"\n").replace(/<br>/gu,"\n").replace(/<div>/gu,"\n").replace(/<\/div>/gu,"").replace(/&nbsp;/gu,""),temp.innerHTML=content,(temp.textContent||temp.innerText).trim()||"")},getArgs=function(arg){var item,args=location.search.substr(1,location.search.length).split("&"),argsArr={};return $.each(args,(function(k,i){if(""==i)return!0;item=i.split("="),argsArr[item[0]]=item[1]})),null!=arg&&null!=argsArr[arg]?argsArr[arg]:(null==arg||null!=argsArr[arg])&&(Object.keys(argsArr).length>0?argsArr:null)},urlExists=function(url){var http=new XMLHttpRequest;return http.open("HEAD",url,!1),http.send(),404!=http.status},showError=function(e){var showId=generateCode("lLLnnn");if(e.responseText){var errData,html="<div>"+e.responseText+"</div>";errData=$(html).find("#container").length>0?'<div class="show_error"><div>'+$(html).find("#container").html()+'</div><button id="'+showId+'">Закрыть</button></div>':'<div class="show_error"><div>'+e.responseText+'</div><button id="'+showId+'">Закрыть</button></div>',$("body").append(errData),$("#"+showId).on(tapEvent,(function(){$(this).parent(".show_error").remove()}))}},getAjaxHtml=function(){let a=arguments,url="string"==typeof a[0]&&("/"!=a[0].substr(0,1)&&"http://"!=a[0].substr(0,7)&&"https://"!=a[0].substr(0,7)?"/"+a[0]:a[0]);if(!url)throw new Error("getAjaxHtml Ошибка! не передан URL");let params="object"==typeof a[1]&&a[1],callback=params||"function"!=typeof a[1]?void 0!==a[2]&&"function"==typeof a[2]&&a[2]:a[1],always="function"==typeof a[1]&&"function"==typeof a[2]?a[2]:"function"==typeof a[2]&&"function"==typeof a[3]&&a[3];$.ajax({url:url,method:"POST",data:params,dataType:"html",success:function(html){(html=html.trim())&&callback?callback(html,!0):callback&&callback('<p class="empty center">Нет данных</p>',!1)},error:function(e){notify("Системная ошибка!","error"),showError(e)},complete:function(){always&&always()}})},getSectionData=function(params,callback){if(null==params)return!1;let data=params.data||{};data.json=1,params.section&&(data.section=params.section),params.template&&(data.template=params.template),$.ajax({url:location.href,method:"POST",data:data,dataType:params.template?"html":"json",success:function(data){params.template?(html=data.trim(),html&&callback?callback(html,!0):callback&&callback('<p class="empty center">Нет данных</p>',!1)):callback(data)},error:function(e){notify("Системная ошибка!","error"),showError(e),callback(!1)}})},$.fn.changeInputs=function(callback){if(0==this.length)return console.warn("changeInputs ошибка! Селектор: не найден!"),!1;if(null==callback||"function"!=typeof callback)return console.warn("changeInputs ошибка! callback функция не задана!"),!1;var keyDownVal;function _getEventData(e){return{t:e.type,k:e.keyCode,s:e.currentTarget.localName,st:null==e.currentTarget.type?"contenteditable":"select-one"==e.currentTarget.type?e.currentTarget.type.replace("select-one","select"):e.currentTarget.type,isShiftKey:e.shiftKey,isCtrlKey:e.ctrlKey,codeShift:16==e.keyCode,codeCtrl:17==e.keyCode,codeEnter:13==e.keyCode,codeX:88==e.keyCode,codeV:86==e.keyCode}}function _setAction(thisItem,eData){callback(thisItem,eData)}$(this).on("change",'select, input[type="checkbox"], input[type="radio"], input[type="color"], input[type="number"]',(function(event){_setAction(this,_getEventData(event))})),$(this).on("keyup keydown","input, textarea, [contenteditable]",(function(event){var eData=_getEventData(event);if(-1!=["text","password","email","tel","number"].indexOf(eData.st)||"textarea"==eData.s&&!eData.codeShift&&!eData.codeCtrl||"contenteditable"==eData.st)if("keydown"==eData.t)keyDownVal="contenteditable"==eData.st?$(this).html():$(this).val();else if("keyup"==eData.t){var thisKeyUpVal="contenteditable"==eData.st?$(this).html():$(this).val();(keyDownVal!==thisKeyUpVal||"contenteditable"==eData.st&&eData.codeEnter)&&(keyDownVal=thisKeyUpVal,_setAction(this,eData))}}))},initEditors=function(){var isLoaded=!1,fontSizes=[],lineHeights=[];for(i=0;i<100;i++)fontSizes.push(""+i),lineHeights.push(i+"px");options={disableDragAndDrop:!0,height:500,lang:"en-US",emptyPara:"",lineHeights:lineHeights,fontSizes:fontSizes,codeviewFilter:!1,codeviewIframeFilter:!0,disableGrammar:!0,codemirror:{theme:"monokai"},toolbar:[["font",["bold","italic","underline","clear"]],["height",["height"]],["style",["style"]],["fontsize",["fontsize"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","image","video"]],["view",["fullscreen","codeview"]]],callbacks:{onChange:function(contents){$(this).closest("tr").find("[save], [update]").length&&$(this).closest("tr").find("[save], [update]").removeAttrib("disabled")}},buttons:{image:function(context){return $.summernote.ui.button({contents:'<i class="note-icon-picture"></i>',tooltip:"тултип",className:"editorfile",click:function(){$("#clientFileManager:not(.visible)").addClass("visible"),currentDir=lscache.get("clientmanagerdir")||!1,currentDir&&!isLoaded&&(getAjaxHtml("filemanager/files_get",{directory:currentDir,filetypes:"png|jpg|jpeg|gif|ico|bmp",client:1},(function(html){$("#clientFilemanagerContentFiles").html(html)})),getAjaxHtml("filemanager/dirs_get",{current_dir:currentDir},(function(html){$("#clientFilemanagerDirs").html(html)})),isLoaded=!0),$("#clientFilemanagerContentFiles").off(tapEvent,".image").on(tapEvent,".image",(function(){var thisFileBlock=$(this).closest(".clientfilemanager__file"),thisFilePath=$(thisFileBlock).attr("dirfile");$(thisFileBlock).attr("namefile"),$(this).find("img").attr("src");context.invoke("editor.insertImage",location.origin+"/public/filemanager/"+thisFilePath),$("#clientFileManager").removeClass("visible")}))}}).render()}}},$("body").find("[editor]:not(.activated)").summernote(options),$("body").find("[editor]").addClass("activated")},ddrInitTabs=function(){var hashData=location.hash.substr(1,location.hash.length).split("."),section=hashData[0];null!=hashData[1]?($("#"+section).find(".tabstitles:not(.sub) li").removeClass("active"),$("#"+section).find(".tabstitles:not(.sub) li#"+hashData[1]).addClass("active"),$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find("[tabid]").removeClass("visible"),$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find('[tabid="'+hashData[1]+'"]').addClass("visible")):($("#"+section).find(".tabstitles:not(.sub) li:first").addClass("active"),$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find("[tabid]:first").addClass("visible")),null!=hashData[2]?$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").length>0&&$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").each((function(){$(this).children("li#"+hashData[2]).length>0?($(this).children("li").removeClass("active"),$(this).children("li#"+hashData[2]).addClass("active"),$(this).siblings(".tabscontent").find("[tabid]").removeClass("visible"),$(this).siblings(".tabscontent").find('[tabid="'+hashData[2]+'"]').addClass("visible")):($(this).children("li:first").addClass("active"),$(this).siblings(".tabscontent").find("[tabid]:first").addClass("visible"))})):$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").length>0&&$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").each((function(){$(this).children("li").removeClass("active"),$(this).children("li:first").addClass("active"),$(this).siblings(".tabscontent").find("[tabid]").removeClass("visible"),$(this).siblings(".tabscontent").find("[tabid]:first").addClass("visible")}))},clientFileManager=function(callback){var activeSelector,currentDir,isLoadedData=!1,fileTypes=!1,typesGroups={all:"png|jpg|jpeg|gif|ico|bmp|mp4|avi|mov|wmv|mpeg|3gp|flv|m4v|mpg|swf|mp3|wav|wma|m3u|ogg|wav|wave|doc|docx|pdf|ppt|pptx|rtf|xls|xlsx|txt|glb|gltf|obj",images:"png|jpg|jpeg|gif|ico|bmp",threed:"glb|gltf|obj",videos:"mp4|avi|mov|wmv|mpeg|3gp|flv|m4v|mpg|swf",audios:"mp3|wav|wma|m3u|ogg|wav|wave",docs:"doc|docx|pdf|ppt|pptx|rtf|xls|xlsx|txt"},filter=["#clientFileManager","[filemanager]",".editorfile"],cb=$.extend({onOpenFilemanager:!1,onRemoveFile:!1,onChooseFile:!1},callback);$("body").append('<div class="clientfilemanager" id="clientFileManager"><div class="clientfilemanager__dirs mb-2"><ul class="noselect" id="clientFilemanagerDirs"></ul></div><div class="clientfilemanager__files noselect" id="clientFilemanagerContentFiles"><p class="empty center">Выберите директорию</p></div></div>'),$("body").off(tapEvent,"[filemanager]").on(tapEvent,"[filemanager]",(function(){if($(this).find("[fileremove]:hover, [filedelete]:hover").length>0)return!1;currentDir=lscache.get("clientmanagerdir")||!1,activeSelector=this,fileTypes&&fileTypes!=$(activeSelector).attr("filemanager")?(fileTypes=$(activeSelector).attr("filemanager")||0,getAjaxHtml("filemanager/files_get",{directory:currentDir,filetypes:typesGroups[fileTypes]||fileTypes,client:1},(function(html){$("#clientFilemanagerContentFiles").html(html)}))):fileTypes=$(activeSelector).attr("filemanager")||0,0!=$("#clientFileManager").hasClass("visible")&&0!=$("#clientFileManager").length||(currentDir&&!isLoadedData&&(getAjaxHtml("filemanager/files_get",{directory:currentDir,filetypes:typesGroups[fileTypes]||fileTypes,client:1},(function(html){$("#clientFilemanagerContentFiles").html(html)})),getAjaxHtml("filemanager/dirs_get",{current_dir:currentDir},(function(html){$("#clientFilemanagerDirs").html(html)})),isLoadedData=!0,null!=cb.onOpenFilemanager&&"function"==typeof cb.onOpenFilemanager&&cb.onOpenFilemanager(activeSelector)),$("#clientFileManager").addClass("visible"))})),$("body").off(tapEvent,"[fileremove], [filedelete]").on(tapEvent,"[fileremove], [filedelete]",(function(e){var thisImgBlock=$(this).closest(".file");ext=$(thisImgBlock).find("[filemanager]").attr("filemanager"),noneImg="none.png",/images|jpg|png|jpeg|ico|bmp/.test(ext)&&(noneImg="none_img.png"),$(this)[0].hasAttribute("fileremove")?($(thisImgBlock).addClass("empty"),$(thisImgBlock).find("[filename]").text(""),$(thisImgBlock).find("[fileimage]").children("img").attr("src","./public/images/"+noneImg),$(thisImgBlock).find("[filesrc]").val(""),null!=cb.onRemoveFile&&"function"==typeof cb.onRemoveFile&&cb.onRemoveFile(thisImgBlock)):$(this)[0].hasAttribute("filedelete")&&($(thisImgBlock).remove(),null!=cb.onDeleteFile&&"function"==typeof cb.onDeleteFile&&cb.onDeleteFile())})),getAjaxHtml("filemanager/dirs_get",{current_dir:currentDir},(function(html){$("#clientFilemanagerDirs").html(html)})),$("#clientFilemanagerDirs").off(tapEvent,"[directory]:not(.disabled):not(.active)").on(tapEvent,"[directory]:not(.disabled):not(.active)",(function(){var thisDirectory=$(this).attr("directory");lscache.set("clientmanagerdir",thisDirectory),$("#clientFilemanagerDirs").find("[directory]").removeClass("active"),$(this).addClass("active"),$("#clientFilemanagerContentFiles").addClass(" clientfilemanager__files_loading"),console.log("before"),getAjaxHtml("filemanager/files_get",{directory:thisDirectory,filetypes:typesGroups[fileTypes]||fileTypes,client:1},(function(html,stat){console.log("after",stat),$("#clientFilemanagerContentFiles").html(html),$("#clientFilemanagerContentFiles").removeClass("clientfilemanager__files_loading")}))})),$("#clientFilemanagerContentFiles").off(tapEvent,".image").on(tapEvent,".image",(function(){var thisFileBlock=$(this).closest(".clientfilemanager__file"),thisFilePath=$(thisFileBlock).attr("dirfile"),thisFileName=$(thisFileBlock).attr("namefile"),thisFileSrc=$(this).find("img").attr("src");$(activeSelector).closest(".file").removeClass("empty"),$(activeSelector).closest(".file").find("[filesrc]").prop("value",thisFilePath),$(activeSelector).closest(".file").find("[fileimage]").children("img").attr("src",thisFileSrc),$(activeSelector).closest(".file").find("[filename]").text(thisFileName),$("#clientFileManager").removeClass("visible"),null!=cb.onChooseFile&&"function"==typeof cb.onChooseFile?cb.onChooseFile(activeSelector):$(activeSelector).addClass("changed")})),$("body").on(tapEvent,(function(){0==$(filter.join(":hover, ")+":hover").length&&$("#clientFileManager").hasClass("visible")&&$("#clientFileManager").removeClass("visible")})),$("#clientFileManager").on("mouseenter",(function(){disableScroll()})),$("#clientFileManager").on("mouseleave",(function(){enableScroll()}))},notify=function(message,className,timeOut){className=className||"success",icon="fa fa-info","success"==className?icon="fa fa-check-circle":"error"==className?icon="fa fa-exclamation-triangle":"info"==className&&(icon="fa fa-info-circle"),$.notify.addStyle("ddr",{html:'<div><i class="'+icon+'"></i><span data-notify-text/></div>'}),$.notify(message,{clickToHide:!0,autoHide:!0,autoHideDelay:timeOut?1e3*timeOut:5e3,arrowShow:!1,arrowSize:15,position:"top right",style:"ddr",className:className,showAnimation:"fadeIn",showDuration:200,hideAnimation:"fadeOut",hideDuration:100,gap:2})},window.selectText=function(elem){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty();let selection=window.getSelection(),range=document.createRange();range.selectNodeContents(elem),selection.removeAllRanges(),selection.addRange(range)},window.getSelectionStr=function(toString=!0){var text="";return window.getSelection?text=toString?window.getSelection().toString():window.getSelection():document.selection&&"Control"!=document.selection.type&&(text=document.selection.createRange().text),text},window.removeSelection=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},window.copyStringToClipboard=function(str=null,notifyStr=!1){if(_.isNull(str))return!1;if(navigator.clipboard)navigator.clipboard.writeText(str);else{let el=document.createElement("textarea");el.value=str,el.setAttribute("readonly",""),el.style.position="absolute",el.style.left="-9999px",document.body.appendChild(el),el.select(),document.execCommand("copy"),document.body.removeChild(el)}notifyStr&&notify(notifyStr)},$.fn.code=function(options={}){const container=this[0];require.config({paths:{vs:"https://unpkg.com/monaco-editor@latest/min/vs"}}),window.MonacoEnvironment={getWorkerUrl:()=>proxy};let editor,proxy=URL.createObjectURL(new Blob(["\n\t\tself.MonacoEnvironment = {\n\t\t\tbaseUrl: 'https://unpkg.com/monaco-editor@latest/min/'\n\t\t};\n\t\timportScripts('https://unpkg.com/monaco-editor@latest/min/vs/base/worker/workerMain.js');\n\t"],{type:"text/javascript"}));const addedActions=[];return new Promise((function(resolve,reject){try{require(["vs/editor/editor.main"],(function(){editor&&editor?.dispose(),editor=monaco.editor.create(container,{value:options?.value,language:options?.language||"javascript",theme:options?.theme||"vs-dark",minimap:{enabled:!1},stickyScroll:{enabled:!1},folding:!1,automaticLayout:!1,fontFamily:"Fira Code",fontSize:15,fontLigatures:!0,fontWeight:"normal",autoIndent:"brackets",renderWhitespace:"none",matchBrackets:"never",cursorBlinking:"solid",renderLineHighlight:"gutter",occurrencesHighlight:"off",trimAutoWhitespace:!1,detectIndentation:!1,insertSpaces:!1,emptySelectionClipboard:!1,guides:{indentation:!1},tabSize:4});const removableIds=options?.actions?options?.actions.map((item=>"vs.editor.ICodeEditor:1:"+item.id)):[];removableIds.push("editor.action.clipboardCutAction","editor.action.clipboardCopyAction","editor.action.clipboardPasteAction");const contextmenu=editor.getContribution("editor.contrib.contextmenu"),realMethod=contextmenu._getMenuActions;if(contextmenu._getMenuActions=function(){const items=realMethod.apply(contextmenu,arguments);return items.map((item=>{"editor.action.clipboardCutAction"==item.id&&(item.label="Вырезать"),"editor.action.clipboardCopyAction"==item.id&&(item.label="Копировать"),"editor.action.clipboardPasteAction"==item.id&&(item.label="Вставить")})),items.filter((function(item){return removableIds.includes(item.id)||/vs.editor.ICodeEditor:/.test(item.id)}))},options?.actions)for(let action of options?.actions){const addedAction=editor.addAction(action);addedActions.push(addedAction)}if(options?.onChange){let mEdit;editor.getModel().onDidChangeContent((event=>{clearTimeout(mEdit),mEdit=setTimeout((()=>{options?.onChange(editor?.getValue(),event)}),options?.changeTimeout||0)}))}resolve({getCode:()=>editor?.getValue(),setCode:data=>editor?.setValue(data),destroy:editor?.dispose,addActions:(actions,clear=!1)=>{addedActions.forEach((action=>action.dispose())),actions.forEach((item=>{const addedAction=editor.addAction(item);addedActions.push(addedAction)}))}})}))}catch(e){reject(e),showError(e)}}))},window.ddrImport=async function(path=null){if(!path)return!1;path.endsWith(".js")&&(path=path.replace(".js","")),path.startsWith("/")&&(path=path.substr(1));try{const loadedModule=await import(`/public/js/${path}.js`);return loadedModule.default||loadedModule}catch(e){throw console.log(e),e}};