setBaseScripts=function(selector){null==selector&&(selector="body"),$(selector).find("[editor]:not(.activated)").length>0&&initEditors(),ddrSelect(selector),ddrPhonecodes(),ddrInitTabs(),$(selector).find("[phonemask]:not([multicode])").each((function(){var phonemask=$(this).attr("phonemask")||"(^^^) ^^^-^^-^^",code=$(this).attr("code")||"+7",placeholder=$(this).attr("placeholder")||(code+" "+phonemask).replace(/[\^&]/g,"_");$(this).mask(code+" "+phonemask,{autoclear:!1}).attr({placeholder:placeholder,type:"tel"})})),$(selector).find("[mask]").each((function(){var placeholder,mask=$(this).attr("mask");if(!mask)return!0;placeholder=$(this).attr("placeholder")||mask.replace(/[\^&]/g,"_"),$(this).mask(mask,{autoclear:!1}).attr({placeholder:placeholder})})),$(selector).find("[numberformat]").each((function(){if(""!=(nf=$(this).attr("numberformat"))){var nf,afterDot=null!=(nf=nf.split("|"))[0]?nf[0]:2,dot=null!=nf[1]?nf[1]:".",space=null!=nf[2]?nf[2]:" ";$(this).number(!0,afterDot,dot,space)}else $(this).number(!0,2,"."," ")})),$(selector).find(".phone ,[phone]").each((function(){$(this).attr("code");$(this).attr("href","tel:"+$(this).text().trim().replace(/-|\(|\)|\s/g,"").replace(/^8/,"+7"))})),$(selector).find(".whatsapp, [whatsapp]").each((function(){var thisMess=$(this).data("message"),thisNumber=$(this).text().trim().replace(/-|\(|\)|\s/g,"").replace(/^8/,"+7");$(this).attr("code");$(this).attr("href","whatsapp://send?phone="+thisNumber+"&abid="+thisNumber+"&text="+thisMess)})),$(selector).find(".email, [email]").each((function(){$(this).attr("href","mailto:"+$(this).text().trim())})),$(selector).find("table.fieldset").length>0&&$(selector).find("table.fieldset").changeInputs((function(item,data){"contenteditable"==data.st&&$(item).closest(".textarea").addClass("changed"),$(item).parent().addClass("changed")})),/#ddrpopup/.test(selector)&&$(selector).changeInputs((function(item,data){"contenteditable"==data.st&&$(item).closest(".textarea").addClass("changed"),$(item).parent().addClass("changed")}))},jQuery(document).ready((function($){setBaseScripts(),$(document).on("focus gesturestart",(function(e){e.preventDefault()})),$("body").on("focus","input, textarea, select",(function(){$(this).parent("div").addClass("focused")})),$("body").on("focus",".file",(function(){$(this).addClass("focused")})),$("body").on("blur","input, textarea, select",(function(){$(this).parent("div").removeClass("focused")})),$("body").on("blur",".file",(function(){$(this).addClass("focused")})),$("body").on("focus","input.error, textarea.error, select.error, .field.error, .textarea.error, .select.error, .file.error",(function(){var thisItem=this;$(thisItem).removeClass("error"),setTimeout((function(){$(thisItem).find("span.error").remove(),$(thisItem).siblings("span.error").remove()}),160)})),$("body").on(tapEvent,".file.error",(function(){var thisItem=this;$(thisItem).removeClass("error"),setTimeout((function(){$(thisItem).find("span.error").remove()}),160)})),$("body").on("submit","form:not([action])",(function(e){return e.preventDefault(),!1})),$("body").on("focus",'input[type="text"]:not([noedit]), input[type="password"]:not([noedit]), input[type="email"]:not([noedit]), input[type="tel"]:not([noedit])',(function(){$(this).removeAttrib("readonly")})),0==/iPhone|iPad|iPod/i.test(navigator.userAgent)&&$("body").on("blur",'input[type="text"]:not([noedit]), input[type="password"]:not([noedit]), input[type="email"]:not([noedit]), input[type="tel"]:not([noedit])',(function(){$(this).setAttrib("readonly")})),$("body").on("change",'input[type="checkbox"]',(function(){$(this)[0].hasAttribute("checked")?($(this).prop("checked",!1),$(this)[0].removeAttribute("checked")):($(this).prop("checked",!0),$(this)[0].setAttribute("checked",""))})),$(window).scrollTop()>2*$(window).height()?$("[scrolltop]").addClass("visible"):$("[scrolltop]").removeClass("visible"),$(window).on("scroll",(function(){$(this).scrollTop()>2*$(window).height()?$("[scrolltop]").addClass("visible"):$("[scrolltop]").removeClass("visible hover")})),$("[scrolltop]").on("click",(function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},800,"easeInOutQuint")})),$("[scrolltop]").on("tap click mouseenter",(function(){$(this).addClass("hover")})),$("[scrolltop]").on("mouseleave",(function(){$(this).removeClass("hover")})),$("body").find("[parallax]").each((function(){var thisParallaxData=$(this).attr("parallax").split("|");$(this).parallax({imageSrc:thisParallaxData[0],speed:parseFloat(thisParallaxData[1])})})),$("body").on(tapEvent,".tabstitles li:not(.active)",(function(){if($(this).find("[ignore]:hover").length>0)return!1;var hashData=location.hash.substr(1,location.hash.length).split("."),thisId=$(this).attr("id"),section=hashData[0],thisTabsTitles=$(this).closest(".tabstitles"),thisTabsContent=$(thisTabsTitles).siblings(".tabscontent");$(this).removeClass("error"),null==hashData[2]&&$("#"+section).find(".tabstitles:not(.sub)").siblings(".tabscontent").find(".tabstitles.sub").each((function(){$(this).children("li").removeClass("active"),$(this).children("li:first").addClass("active"),$(this).siblings(".tabscontent").find("[tabid]").removeClass("visible"),$(this).siblings(".tabscontent").find("[tabid]:first").addClass("visible")})),$(thisTabsTitles).children("li").removeClass("active"),$(this).addClass("active"),0==$(thisTabsTitles).hasClass("sub")?location.hash=section+"."+thisId:(hashData[1]||(hashData[1]=$(this).closest("#"+section).find(".tabstitles:not(.sub)").children(":first").attr("id")),location.hash=section+"."+hashData[1]+"."+thisId),0==$(thisTabsContent).children('[tabid="'+thisId+'"]').hasClass("visible")&&($(thisTabsContent).children("[tabid]").removeClass("visible"),$(thisTabsContent).children('[tabid="'+thisId+'"]').addClass("visible"),$(document).trigger("tabsChange",thisId)),initEditors()})),$("body").on(tapEvent,"[showpassword]",(function(){$(this).parent().find('input[type="password"]').length>0?($(this).parent().find('input[type="password"]').prop("type","text"),$(this).removeClass("fa-eye").addClass("fa-eye-slash").prop("title","Скрыть пароль")):$(this).parent().find('input[type="text"]').length>0&&($(this).parent().find('input[type="text"]').prop("type","password"),$(this).removeClass("fa-eye-slash").addClass("fa-eye").prop("title","Показать пароль"))})),$("#adminSetModifications").on("change",(function(){var modification=$(this).val();$.post("/admin/modifications/set_modification",{controller:"admin",mod:modification},(function(result){result&&pageReload()}),"json")})),$("body").on(tapEvent,"[modification]",(function(){var modification=$(this).attr("modification");$.post("/admin/modifications/set_modification",{controller:"site",mod:modification},(function(result){result&&pageReload()}),"json")})),$("body").on(tapEvent,"[ddrsort]",(function(){ddrSort(this)})),$("body").on("focus","[ddrtextarealist]",(function(){var h,textarea=this,data=$(textarea).attr("ddrtextarealist"),join=($(textarea).attr("load"),$(textarea).attr("join")||";");if($("body").find("[ddraladd]").off(tapEvent),$("body").find(".textarea__addblock").find("input, select").off("keyup"),data){var mainHtml="",html="",fields=data.split("|");$.each(fields,(function(k,f){if(!f)return!0;let fd=f.split(";");if(t=fd[0]||null,l=fd[1]||null,d=fd[2]||null,c=fd[3]||null,p=fd[4]||null,!t)return!0;if(html+='<div class="dcol'+(c?"-auto "+c:"")+'">',html+='<label class="textareafields__label" for="ddrtextarealistfield'+k+'">'+l+"</label>","select"==t){let ol=d.split(",");html+='<select id="ddrtextarealistfield'+k+'" tabid="'+k+'">',$.each(ol,(function(k,o){if(!o)return!0;var si=o.split(":"),v=si[0],t=null!=si[1]?si[1]:si[0];html+='<option value="'+v+'">'+t+"</option>"})),html+="</select>"}else if("checkbox"==t){let checked=1==d?" checked":"";html+='<div class="checkbox">',html+='<div class="checkbox__item checkbox__item_ver2 checkbox__item_small h-24px">',html+="<div>",html+='<input id="ddrtextarealistfield'+k+'" type="checkbox"'+checked+' tabid="'+k+'" />',html+='<label for="ddrtextarealistfield'+k+'"></label>',html+="</div>",html+="</div>",html+="</div>"}else if("number"==t){var val=null!=d?' value="'+d+'"':"",placeholder=p?' placeholder="'+p+'"':"";html+='<input id="ddrtextarealistfield'+k+'" type="number"'+val+placeholder+' showrows tabid="'+k+'" />'}else if("text"==t){val=null!=d?' value="'+d+'"':"",placeholder=p?' placeholder="'+p+'"':"";html+='<input id="ddrtextarealistfield'+k+'" type="text"'+val+placeholder+' tabid="'+k+'" />'}html+="</div>"}))}function _addRow(){var data=[],tWrap=$(textarea).parent(".textarea");$(textarea).siblings(".textarea__addblock").find("input, select").each((function(k,i){"checkbox"==i.type?data.push($(i).is(":checked")?1:0):data.push($(i).val())})),""!=$(textarea).val()?$(textarea).val($(textarea).val()+"\n"+data.join(join)):$(textarea).val(data.join(join)),tWrap.length&&$(tWrap).addClass("changed"),$(textarea).siblings(".textarea__addblock").find("input").val(""),$(textarea).siblings(".textarea__addblock").find("select").children("option").removeAttrib("selected"),$(textarea).siblings(".textarea__addblock").find("select").children("option:first").prop("selected",!0),$(textarea).scrollTop(999999999),$(textarea).siblings(".textarea__addblock").find('[class ^= "dcol"]:first').find("inpus, select").focus()}$(textarea).setAttrib("touch","textarea_opened"),mainHtml+='<div class="textarea__addblock">',mainHtml+='<div class="textareafields"><div class="drow dgutter-4">'+html+"</div></div>",mainHtml+='<div class="textareabutton"><button ddraladd title="Добавить строку"><i class="fa fa-plus"></i></button></div>',mainHtml+="</div>",0==$(textarea).siblings(".textarea__addblock").length&&$(textarea).after(mainHtml),h=$(textarea).siblings(".textarea__addblock").height(),$(textarea).siblings(".textarea__addblock").css("bottom",-h+"px"),$(textarea).siblings(".textarea__addblock").find("input, select").on("keyup",(function(e){13==e.keyCode&&_addRow()})),$(textarea).siblings(".textarea__addblock").find("[ddraladd]").on(tapEvent,(function(){_addRow()}))}))}));